name: 'Run Tests'
description: 'Runs Django tests for the application'

inputs:
  db_host:
    description: 'Database host'
    required: false
    default: 'localhost'
  db_port:
    description: 'Database port'
    required: false
    default: '5432'
  db_name:
    description: 'Database name'
    required: true
  db_user:
    description: 'Database user'
    required: true
  db_password:
    description: 'Database password'
    required: true
  secret_key:
    description: 'Django secret key'
    required: true

runs:
  using: 'composite'
  steps:
    - name: Run tests
      shell: bash
      env:
        ENVIRONMENT: test
        DB_HOST: ${{ inputs.db_host }}
        DB_PORT: ${{ inputs.db_port }}
        DB_NAME: ${{ inputs.db_name }}
        DB_USER: ${{ inputs.db_user }}
        DB_PASSWORD: ${{ inputs.db_password }}
        SECRET_KEY: ${{ inputs.secret_key }}
      run: |
        cd src
        uv run pytest
